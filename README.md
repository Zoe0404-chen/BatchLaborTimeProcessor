# 批次检验工时计算工具 README

## 项目概述

**批次检验工时计算工具** 是一个基于 Python 的图形用户界面 (GUI) 应用程序，旨在自动化计算制造过程中批次检验所需的工时。该工具通过读取 Excel 数据文件，结合用户输入的批量大小和检验规则，生成详细的工时计算结果，适用于质量控制和生产计划场景。程序使用 Tkinter 提供直观的用户界面，支持 AQL 抽样标准，并生成包含计算结果和调试信息的 Excel 输出文件。

- **版本**: 1.0
- **最后更新**: 2025-06-10
- **开发者**: Chen Jinzhuo
- **联系方式**: Jinzhuo.Chen@Zimmerbiomet.com

## 功能特性

1. **数据输入与验证**:
   - 支持从 Excel 文件 (`whole_rawdata.xlsx`, `batch_num.xlsx`, `database.xlsx`, `BOM.xlsx`) 导入检验数据、批次信息、量具工时映射和物料清单。
   - 验证文件路径、格式及必要列，确保数据完整性。
   - 支持用户指定批量大小，或基于历史数据自动计算默认批量大小。

2. **AQL 抽样计算**:
   - 根据 AQL 标准 (1.0, 1.5, 2.5, 4.0, 10.0) 和批次大小确定抽样数量。
   - 支持多种抽样频率，包括首末件、100% 全检、单件/批次及 AQL 抽样。

3. **工时计算**:
   - 基于量具编码和抽样数量计算单件工时及批次总工时。
   - 自动计算批量准备工时，考虑特殊量具（如光学影像仪、粗糙度仪）和外协工序的额外时间。
   - 与 BOM 数据集成，比较变更前后的批量准备工时和单件工时。

4. **输出与调试**:
   - 生成 Excel 输出文件，包含两个工作表：
     - **Sheet1**: 按产品和工序汇总的工时数据，包括变更前后工时对比。
     - **Sheet2**: 详细的检验记录，包含抽样频率、量具编码等。
   - 提供调试信息工作表 (`DebugInfo`)，记录处理过程中的信息、警告和错误。
   - 支持一键打开输出文件。

5. **用户界面**:
   - 使用 Tkinter 构建，直观易用，支持文件浏览、批量大小输入、进度条显示及状态提示。
   - 显示详细的检验规则说明，便于用户理解计算逻辑。

## 系统要求

- **操作系统**: Windows, macOS, 或 Linux
- **Python 版本**: Python 3.8 或更高版本
- **依赖库**:
  - pandas
  - numpy
  - tkinter
  - xlsxwriter
  - openpyxl
- **硬件要求**: 最低 4GB 内存，建议 8GB 以上；至少 500MB 可用磁盘空间。
- **输入文件**:
  - `whole_rawdata.xlsx`: 检验卡数据
  - `batch_num.xlsx`: 批次及开单数量数据
  - `database.xlsx`: 量具工时映射
  - `BOM.xlsx`: 物料清单数据

## 安装与运行

1. **安装 Python**:
   - 从 [Python 官方网站](https://www.python.org/) 下载并安装 Python 3.8 或更高版本。
   - 确保在安装时勾选“Add Python to PATH”。

2. **安装依赖库**:
   - 打开终端或命令提示符，运行以下命令：
     ```bash
     pip install pandas numpy tkinter xlsxwriter openpyxl
