使用指南
启动程序:
运行程序后，GUI 窗口将显示标题、文件路径输入框、批量大小输入框、进度条、状态标签及操作按钮。
选择检验卡文件:
点击“浏览”按钮，选择 whole_rawdata.xlsx 文件。
文件路径将显示在输入框中，状态标签更新为“文件已选择”。
输入批量大小（可选）:
在“批量大小”输入框中输入正整数，表示批次大小。
若留空，程序将使用 batch_num.xlsx 中开单数量的中位数作为默认值。
提交处理:
点击“提交”按钮，程序开始处理数据。
进度条显示处理状态，状态标签更新为“正在处理数据，请稍候...”。
查看结果:
处理完成后，程序提示输出文件路径，并显示未匹配量具数量及工时为 0 的记录数。
点击“打开输出文件”按钮，自动打开生成的 Excel 文件。
输出文件包含 Sheet1（汇总工时）、Sheet2（详细记录）和 DebugInfo（调试信息）。
退出程序:
点击“退出”按钮关闭程序。
输入文件格式
以下为各输入文件的必要列及说明：

whole_rawdata.xlsx:
产品编码: 产品唯一标识符（字符串）。
检验卡编号: 检验卡唯一标识符。
版本: 检验卡版本。
工艺编号: 工艺标识符（字符串）。
工序号: 工序编号（字符串，需补零至 4 位）。
工序名称: 工序描述。
量具1层编码: 主要量具编码（字符串，大写，移除多余空格）。
量具2层编码: 次要量具编码（可选）。
抽样频率: 抽样规则（如“首末件”、“100%”、“AQL1.0 C=0”）。
是否检验: 是否需要检验（“是”或“否”）。
尺寸内容: 检验项描述。
batch_num.xlsx:
Material Number: 产品编码（字符串）。
Batch: 批次编号。
Order quantity (GMEIN): 开单数量（数值）。
database.xlsx:
列 1: 量具编码（字符串，大写，移除多余空格）。
列 3: 对应工时（小时，数值）。
BOM.xlsx:
Description: 工艺编号（字符串，大写）。
Operation/Activity N: 工序号（字符串，补零至 4 位）。
Production Version: 生产版本。
Setup Personal time: 批量准备工时。
Labor time: 单件工时。
检验规则说明
程序内置以下检验规则，显示在 GUI 界面中，用户需根据实际情况自行调整：

批次准备工时（默认 +0.1 小时/批次）:
投影仪多个视角摆放。
终检/外协拆包装检验（如 Web3-FEM PRO 42-5047-066-02）。
托盘包装的 DRILL 产品。
特殊量具（如光学影像仪、粗糙度仪）每种增加 0.1 小时。
包含“外协”的工序名称增加 0.1 小时。
检验时间（需手动调整）:
自动测量程序（不含 CMM 等非专员操作）:
OGP 程序测量。
闪测仪程序测量。
轮廓仪程序测量。
粗糙度仪。
属性检验项:
孔检验数量。
螺纹检验数量。
单份投影纸检验视图数量。
功能规覆盖的检验项数。
输出文件说明
生成的文件包含以下工作表：

Sheet1（工时汇总）:
列: 产品编码、检验卡编号、版本、工艺编号、Production Version、工序号、工序名称、变更前/后批量准备工时、变更前/后单件工时、批次工时、批次大小。
用途: 提供按工序汇总的工时数据，便于比较变更前后差异。
Sheet2（详细记录）:
列: 产品编码、检验卡编号、版本、工艺编号、Production Version、工序号、工序名称、尺寸内容、量具1层/2层编码、批次大小、抽样频率、是否检验、抽样数量、单件工时、工时。
用途: 提供每条检验记录的详细信息，便于追溯。
DebugInfo（调试信息）:
列: 时间戳、类别（信息/警告/错误）、信息。
用途: 记录处理过程中的日志，帮助诊断问题。
注意事项
文件路径:
确保输入文件位于程序运行目录或通过 GUI 指定正确路径。
输出文件保存路径由用户通过对话框选择，避免覆盖现有文件。
数据完整性:
确保输入文件包含必要列，且数据格式正确（如数值型列无文本）。
量具编码需与 database.xlsx 一致，否则工时可能为 0。
批量大小:
用户输入的批量大小优先于默认值。
若批量大小为 0，单件工时将设为 0，并记录警告。
错误处理:
程序会捕获并记录所有错误，显示在状态标签或消息框中。
调试信息保存在输出文件的 DebugInfo 工作表，便于问题排查。
性能:
处理大数据集时，可能需要较长时间，进度条会显示状态。
建议优化输入文件，移除冗余数据以提高效率。
常见问题解答
Q: 程序报错“文件不存在或无法访问”怎么办？
A: 检查文件路径是否正确，确保文件位于指定目录且具有读取权限。
Q: 为什么输出文件中部分工时为 0？
A: 可能原因包括：
量具编码未在 database.xlsx 中定义。
抽样频率无效或批次大小为 0。
检查 DebugInfo 工作表中的警告信息。
Q: 如何修改 AQL 抽样表？
A: AQL 抽样表定义在程序代码中的 AQL_SAMPLE_SIZE 字典。修改需编辑源代码并重新运行。
Q: 程序运行缓慢怎么办？
A: 优化输入文件，减少行数或冗余数据。确保系统资源充足（如内存）。
反馈与支持
如有问题或建议，请通过以下方式联系开发者：

邮箱: Jinzhuo.Chen@Zimmerbiomet.com
主题: 批次检验工时计算工具反馈
请提供问题描述、输入文件样本（若可共享）及 DebugInfo 工作表内容，以便快速定位问题。

版权信息
© 2025 批次检验工时计算参考 V1.0

开发者: Chen Jinzhuo
